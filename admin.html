<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Real-time Firebase</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #4f46e5; --bg: #f1f5f9; --white: #ffffff; --text: #1e293b; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); display: flex; }

        /* Sidebar */
        .sidebar { width: 260px; height: 100vh; background: var(--primary); color: white; padding: 20px; position: fixed; }
        .sidebar h2 { margin-bottom: 30px; text-align: center; font-size: 20px; }
        .menu-item { padding: 12px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; transition: 0.3s; }
        .menu-item:hover { background: rgba(255,255,255,0.1); }

        /* Main Content */
        .main-content { margin-left: 260px; padding: 30px; width: 100%; }
        .data-card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 30px; }
        
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 12px; background: #f8fafc; color: #64748b; border-bottom: 2px solid #eee; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 14px; }
        
        .status-badge { padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: bold; }
        .status-paid { background: #dcfce7; color: #166534; }

        .loading { text-align: center; padding: 20px; color: var(--primary); font-weight: bold; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>FollBooster Admin</h2>
    <div class="menu-item"><i class="fas fa-users"></i> <span>Data Pengguna</span></div>
    <div class="menu-item"><i class="fas fa-shopping-cart"></i> <span>Pesanan Masuk</span></div>
</div>

<div class="main-content">
    <div class="data-card">
        <h2>Daftar Pengguna (Firebase)</h2>
        <table>
            <thead>
                <tr>
                    <th>Email</th>
                    <th>Nama</th>
                    <th>Status</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="user-table-body">
                <tr><td colspan="4" class="loading">Menghubungkan ke Firebase...</td></tr>
            </tbody>
        </table>
    </div>

    <div class="data-card">
        <h2>Pesanan Terbaru</h2>
        <table>
            <thead>
                <tr>
                    <th>Target ID</th>
                    <th>Paket</th>
                    <th>Harga</th>
                    <th>Waktu</th>
                </tr>
            </thead>
            <tbody id="order-table-body">
                <tr><td colspan="4" class="loading">Menunggu pesanan baru...</td></tr>
            </tbody>
        </table>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // CONFIG KAMU BUJANG!
        const firebaseConfig = {
            apiKey: "AIzaSyBClYBiQ3Z0q4_rbsGPyi-hDz5gn6NU4GI",
            authDomain: "follbooster.firebaseapp.com",
            databaseURL: "https://follbooster-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "follbooster",
            storageBucket: "follbooster.firebasestorage.app",
            messagingSenderId: "199636680075",
            appId: "1:199636680075:web:f306267423dd6e955ec38e"
        };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. FUNGSI AMBIL DATA USER
    function fetchUsers() {
        const userTable = document.getElementById('user-table-body');
        
        db.ref('users').on('value', (snapshot) => {
            userTable.innerHTML = ""; // Bersihkan loading
            snapshot.forEach((childSnapshot) => {
                const data = childSnapshot.val();
                let row = `<tr>
                    <td>${data.email || 'No Email'}</td>
                    <td>${data.username || 'User'}</td>
                    <td><span class="status-badge status-paid">Aktif</span></td>
                    <td><button onclick="deleteUser('${childSnapshot.key}')" style="color:red; border:none; background:none; cursor:pointer;">Hapus</button></td>
                </tr>`;
                userTable.innerHTML += row;
            });
        });
    }

    // 3. FUNGSI AMBIL DATA PESANAN
    function fetchOrders() {
        const orderTable = document.getElementById('order-table-body');
        
        db.ref('orders').on('value', (snapshot) => {
            orderTable.innerHTML = "";
            snapshot.forEach((childSnapshot) => {
                const order = childSnapshot.val();
                let row = `<tr>
                    <td><b>${order.target_id}</b></td>
                    <td>${order.nama_paket}</td>
                    <td>${order.harga_paket}</td>
                    <td>${order.timestamp || '-'}</td>
                </tr>`;
                orderTable.innerHTML += row;
            });
        });
    }

    // Fungsi Hapus User (Hanya contoh aksi)
    function deleteUser(id) {
        if(confirm("Hapus user ini?")) {
            db.ref('users/' + id).remove();
        }
    }

    // Jalankan saat halaman load
    window.onload = () => {
        fetchUsers();
        fetchOrders();
    };
</script>

</body>
</html>